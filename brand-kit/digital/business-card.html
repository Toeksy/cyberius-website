<!doctype html>
<html lang="fi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="version" content="2025-12-17-6" />
  <title>Codesphere - Digitaalinen käyntikortti</title>
  <style>
    :root {
      --primary: #1e3a5f;
      --accent: #00ffff;
      --accent-rgb: 0, 255, 255;
      --bg: #0a0f1a;
      --text: #f1f5f9;
      --muted: #94a3b8;
      --panel: rgba(255, 255, 255, 0.04);
      --border: rgba(255, 255, 255, 0.10);
      --font: -apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", system-ui, sans-serif;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: var(--font);
      background: radial-gradient(1200px 700px at 15% 20%, rgba(var(--accent-rgb), 0.12), transparent 55%),
                  radial-gradient(1100px 650px at 90% 85%, rgba(30, 58, 95, 0.20), transparent 60%),
                  var(--bg);
      color: var(--text);
      display: grid;
      place-items: center;
      padding: 24px;
    }

    .card {
      width: min(1050px, 100%);
      aspect-ratio: 1050 / 600;
      border-radius: 26px;
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border: 2px solid rgba(var(--accent-rgb), 0.22);
      box-shadow:
        0 0 0 1px rgba(255,255,255,0.06) inset,
        0 0 40px rgba(var(--accent-rgb), 0.10),
        0 0 90px rgba(var(--accent-rgb), 0.08);
      position: relative;
      overflow: hidden;
      min-height: 0;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 20% 20%, rgba(var(--accent-rgb), 0.14), transparent 55%),
        radial-gradient(circle at 80% 70%, rgba(30,58,95,0.18), transparent 55%);
      filter: blur(18px);
      pointer-events: none;
    }



    .inner {
      position: absolute;
      inset: 26px;
      display: grid;
      grid-template-columns: 1.05fr 0.95fr;
      gap: 22px;
      align-items: stretch;
      z-index: 1;
    }

    .left {
      display: grid;
      align-items: center;
    }

    .right {
      display: grid;
      grid-template-rows: auto 1fr auto;
      padding: 8px 6px 8px 0;
    }

    .brand {
      font-weight: 900;
      letter-spacing: 0.06em;
      font-size: clamp(20px, 2.4vw, 36px);
      margin-top: 2px;
      background: linear-gradient(135deg, var(--text), var(--accent));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .sub {
      margin-top: 6px;
      color: var(--muted);
      font-size: clamp(12px, 1.2vw, 16px);
    }

    .divider {
      height: 2px;
      background: linear-gradient(90deg, rgba(var(--accent-rgb), 0.40), rgba(var(--accent-rgb), 0.05));
      margin: 14px 0 18px;
      border-radius: 999px;
    }

    .people {
      display: grid;
      gap: 16px;
      align-content: start;
    }

    .person .name {
      font-weight: 800;
      font-size: clamp(14px, 1.5vw, 22px);
      margin: 0;
    }

    .person .title {
      margin: 4px 0 0;
      color: rgba(148, 163, 184, 0.95);
      font-size: clamp(11px, 1.15vw, 15px);
    }

    .person .phone {
      margin: 5px 0 0;
      color: var(--accent);
      font-weight: 700;
      font-size: clamp(12px, 1.15vw, 16px);
    }

    .footer {
      color: rgba(148, 163, 184, 0.9);
      font-size: 12px;
      display: flex;
      justify-content: space-between;
      gap: 12px;
      align-items: center;
    }

    .build {
      color: rgba(148, 163, 184, 0.75);
      font-size: 11px;
      white-space: nowrap;
    }

    .footer a {
      color: var(--accent);
      text-decoration: none;
      border: 1px solid rgba(var(--accent-rgb), 0.28);
      background: rgba(var(--accent-rgb), 0.08);
      padding: 8px 10px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 12px;
    }

    .footer button {
      color: var(--accent);
      border: 1px solid rgba(var(--accent-rgb), 0.28);
      background: rgba(var(--accent-rgb), 0.08);
      padding: 8px 10px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 12px;
      cursor: pointer;
      font-family: var(--font);
    }

    .brand-link { text-decoration: none; display: inline-block; }
    #refreshFrame { white-space: nowrap; }

    .footer a:hover { background: rgba(var(--accent-rgb), 0.13); }
    .footer button:hover { background: rgba(var(--accent-rgb), 0.13); }

    .footer-actions {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: flex-end;
    }

    .footer-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
      align-items: center;
    }

    .share-label {
      color: rgba(148, 163, 184, 0.9);
      font-weight: 800;
      font-size: 12px;
      letter-spacing: 0.02em;
      margin-right: 2px;
    }

    .lang {
      color: rgba(241,245,249,0.85);
      border: 1px solid rgba(var(--accent-rgb), 0.20);
      background: rgba(0,0,0,0.22);
      padding: 8px 10px;
      border-radius: 12px;
      font-weight: 800;
      font-size: 12px;
      outline: none;
    }

    .lang.top {
      padding: 6px 8px;
      border-radius: 999px;
      font-size: 11px;
    }

    .lang option { background: #0a0f1a; }

    html[dir="rtl"] body { direction: rtl; }
    html[dir="rtl"] .right { text-align: right; padding: 8px 0 8px 6px; }
    html[dir="rtl"] .footer { flex-direction: row-reverse; }
    html[dir="rtl"] .people { text-align: right; }
    html[dir="rtl"] .person .phone { direction: ltr; unicode-bidi: plaintext; }

    /* Browser mock */
    .browser {
      height: 100%;
      border-radius: 18px;
      background: rgba(8, 12, 20, 0.62);
      border: 1px solid rgba(var(--accent-rgb), 0.18);
      box-shadow:
        0 0 0 1px rgba(255,255,255,0.06) inset,
        0 0 30px rgba(var(--accent-rgb), 0.10);
      overflow: hidden;
      position: relative;
    }

    .browser::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, transparent 35%, rgba(255,255,255,0.06), transparent 62%);
      transform: translateX(-65%);
      opacity: 0;
      pointer-events: none;
      mix-blend-mode: screen;
      opacity: 0.85;
    }



    .topbar {
      height: 46px;
      display: grid;
      grid-template-columns: auto 1fr;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }

    .dots { display: flex; gap: 7px; }
    .dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.18);
      box-shadow: 0 0 0 1px rgba(255,255,255,0.12) inset;
    }

    .addr {
      height: 26px;
      border-radius: 999px;
      border: 1px solid rgba(var(--accent-rgb), 0.20);
      background: rgba(0,0,0,0.22);
      display: flex;
      align-items: center;
      padding: 0 10px;
      color: rgba(241,245,249,0.85);
      font-weight: 700;
      font-size: 12px;
      letter-spacing: 0.02em;
      overflow: hidden;
      position: relative;
    }

    .addr::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, transparent 0%, rgba(var(--accent-rgb), 0.12) 50%, transparent 100%);
      transform: translateX(-100%);
      opacity: 0;
    }

    @keyframes addrGlow {
      0%, 50% { transform: translateX(-120%); opacity: 0; }
      65% { opacity: 1; }
      100% { transform: translateX(120%); opacity: 0; }
    }

    .viewport {
      height: calc(100% - 46px);
      background: #000;
      position: relative;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: 0;
      background: #000;
    }

    .poster {
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      background: #000;
      gap: 14px;
      padding: 16px;
      text-align: center;
      color: rgba(241,245,249,0.92);
    }

    .poster img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 12px;
      border: 1px solid rgba(var(--accent-rgb), 0.15);
      box-shadow: 0 12px 40px rgba(0,0,0,0.45);
    }

    .poster button {
      color: var(--accent);
      border: 1px solid rgba(var(--accent-rgb), 0.28);
      background: rgba(var(--accent-rgb), 0.08);
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 800;
      font-size: 13px;
      cursor: pointer;
      font-family: var(--font);
      letter-spacing: 0.01em;
    }

    .poster button:hover { background: rgba(var(--accent-rgb), 0.13); }

    .hint {
      font-size: 11px;
      color: rgba(241,245,249,0.72);
      background: rgba(0,0,0,0.35);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 12px;
      padding: 6px 9px;
      backdrop-filter: blur(6px);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .orientation-tip { display: none !important; }

    /* Narrow screens: stack content vertically */
    @media (max-width: 720px) {
      body { padding: 8px; }
      
      .card {
        aspect-ratio: auto;
        min-height: calc(100vh - 16px);
        min-height: calc(100dvh - 16px);
        border-radius: 20px;
      }
      
      .inner {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto;
        gap: 14px;
        inset: 12px;
      }
      
      .left { min-height: 300px; }
      .right { padding: 0; gap: 10px; }
      
      .brand { font-size: clamp(22px, 4.5vw, 30px); }
      .sub { font-size: clamp(12px, 3vw, 14px); }
      
      .person .name { font-size: clamp(15px, 3.6vw, 19px); }
      .person .title { font-size: clamp(11px, 3vw, 13px); }
      .person .phone { font-size: clamp(12px, 3vw, 14px); }
      
      .people { gap: 10px; }
      
      .footer { 
        flex-direction: column; 
        align-items: flex-start; 
        gap: 10px;
        font-size: 10.5px;
      }
      
      .footer-actions { 
        width: 100%;
        align-items: flex-start; 
        gap: 8px;
      }
      
      .footer-row { 
        width: 100%;
        justify-content: flex-start; 
        gap: 8px;
      }
      
      .footer a, .footer button { 
        padding: 9px 11px; 
        font-size: 12px;
        flex: 0 1 auto;
      }
      
      .browser { border-radius: 14px; }
      .topbar { height: 40px; padding: 8px 10px; }
      .dots { gap: 5px; }
      .dot { width: 8px; height: 8px; }
      .addr { font-size: 11px; padding: 0 8px; height: 24px; }
      .viewport { height: calc(100% - 40px); }
    }

    /* Wider mobiles / small tablets: keep two columns (no orientation dependency) */
    @media (min-width: 721px) and (max-width: 900px) {
      body { padding: 10px; }
      .card {
        aspect-ratio: auto;
        border-radius: 18px;
        min-height: 85vh;
        min-height: 85dvh;
        width: min(920px, 92vw);
        margin: 0 auto;
      }
      .inner {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr;
        gap: 12px;
        inset: 12px;
      }
      .left { min-height: 220px; }
      .right { padding: 0 6px; gap: 9px; }
      .brand { font-size: clamp(20px, 2.8vw, 26px); }
      .sub { font-size: clamp(11px, 2.2vw, 13px); }
      .people { gap: 8px; }
      .person .name { font-size: clamp(14px, 2.2vw, 18px); }
      .person .title { font-size: clamp(10px, 2vw, 13px); }
      .person .phone { font-size: clamp(11px, 2.1vw, 14px); }
      .footer { font-size: 10px; gap: 6px; }
      .footer a, .footer button { padding: 7px 9px; font-size: 11px; }
      .topbar { height: 38px; padding: 8px 10px; }
      .addr { font-size: 11px; height: 24px; padding: 0 8px; }
      .viewport { height: calc(100% - 38px); }
    }

    /* Mid landscape (900-1280px width) */
    @media (min-width: 901px) and (max-width: 1280px) and (orientation: landscape) {
      body { padding: 14px; display: block; overflow-y: auto; }
      .card {
        width: clamp(760px, 90vw, 980px);
        margin: 0 auto;
        min-height: auto;
      }
      .inner {
        grid-template-columns: 1.05fr 0.95fr;
        grid-template-rows: 1fr;
        gap: 10px;
      }
      .left { min-height: 220px; }
      .right { padding: 0 6px; gap: 8px; }
      .brand { font-size: clamp(17px, 2vw, 24px); }
      .sub { font-size: clamp(11px, 1.8vw, 13px); }
      .people { gap: 8px; }
      .person .name { font-size: clamp(13px, 1.9vw, 17px); }
      .person .title { font-size: clamp(10px, 1.7vw, 12px); }
      .person .phone { font-size: clamp(11px, 1.8vw, 13px); }
      .footer { font-size: 10.5px; gap: 7px; }
      .footer a, .footer button { padding: 8px 9px; font-size: 11px; }
    }

    /* Force two columns even on small landscape widths */
    @media (max-width: 900px) and (orientation: landscape) {
      body { padding: 12px; display: block; overflow-y: auto; }
      .card {
        width: clamp(620px, 88vw, 900px);
        margin: 0 auto;
        min-height: auto;
      }
      .inner {
        grid-template-columns: 1.08fr 0.92fr;
        grid-template-rows: 1fr;
        gap: 8px;
      }
      .left { min-height: 200px; }
      .right { padding: 0 4px; gap: 6px; }
      .brand { font-size: clamp(15px, 1.9vw, 20px); }
      .sub { font-size: clamp(10px, 1.6vw, 12px); }
      .people { gap: 6px; }
      .person .name { font-size: clamp(11.5px, 1.8vw, 15px); }
      .person .title { font-size: clamp(9px, 1.5vw, 11px); }
      .person .phone { font-size: clamp(10px, 1.6vw, 12px); }
      .footer { font-size: 10px; gap: 6px; }
      .footer a, .footer button { padding: 7px 8px; font-size: 11px; }
    }
  </style>
</head>
<body>
  <main class="card" role="img" aria-label="Codesphere digitaalinen käyntikortti">
    <div class="orientation-tip" id="orientationTip">Paras kokemus vaakana</div>
    <div class="inner">
      <section class="left">
        <div class="browser" aria-label="Selaimen esikatselu: Codesphere-sivusto">
          <div class="topbar">
            <div class="dots" aria-hidden="true">
              <div class="dot"></div>
              <div class="dot"></div>
              <div class="dot"></div>
            </div>
            <div class="addr"><span>codesphere</span><span style="opacity:.7">.fi</span></div>
            <select class="lang top" id="langTop" aria-label="Language"></select>
          </div>
          <div class="viewport">
            <iframe id="site" title="Codesphere-sivusto" data-src="../../index.html" loading="lazy"></iframe>
            <div class="poster" id="poster">
              <img src="../social/og.png" alt="Codesphere esikatselu" />
              <button id="openLive">Avaa live-versio</button>
              <div class="hint">Hidas yhteys? Näytä staattinen esikatselu.</div>
            </div>
          </div>
        </div>
      </section>

      <section class="right">
        <header>
          <a class="brand brand-link" href="https://codesphere.fi" target="_blank" rel="noopener">CODESPHERE</a>
          <div class="sub" data-i18n="subtitle">Yhteystiedot</div>
          <div class="divider"></div>
        </header>

        <div class="people">
          <div class="person">
            <p class="name">Timo Aula</p>
            <p class="title" data-i18n="timoTitle">Toimitusjohtaja, Böethius Oy • Ohjelmistokehityksen asiantuntija</p>
            <p class="phone" data-phone="+358 45 7977 3133">puh +358 45 7977 3133</p>
          </div>
          <div class="person">
            <p class="name">Matti Erholtz</p>
            <p class="title" data-i18n="mattiTitle">Hallituksen jäsen • Markkinointijohtaja &amp; Tekoälyarkkitehti</p>
            <p class="phone" data-phone="+358 40 193 2714">puh +358 40 193 2714</p>
          </div>
          <div class="person">
            <p class="name">Mika Leppänen</p>
            <p class="title" data-i18n="mikaTitle">Kyberturvallisuusasiantuntija • Asiantuntijatodistelu (tuomioistuimet)</p>
            <p class="phone" data-phone="+358 46 558 1732">puh +358 46 558 1732</p>
          </div>
        </div>

        <div class="footer">
          <div data-i18n="tagline">codesphere | globaalia ohjelmistokehitystä</div>
          <div class="build" id="buildTag" aria-label="Build"></div>
          <div class="footer-actions">
            <div class="footer-row">
              <select class="lang" id="lang" aria-label="Language"></select>
              <a href="contacts.vcf" download data-i18n="downloadVcard">vCard</a>
              <a href="business-card.png" target="_blank" rel="noopener" data-i18n="openPng">Avaa PNG-käyntikortti</a>
              <button id="refreshFrame" type="button">Päivitä esikatselu</button>
            </div>
            <div class="footer-row" aria-label="Share">
              <span class="share-label" data-i18n="shareLabel">Jaa</span>
              <a id="shareWhatsApp" href="#" target="_blank" rel="noopener" data-i18n="shareWhatsApp">WhatsApp</a>
              <a id="shareFacebook" href="#" target="_blank" rel="noopener" data-i18n="shareFacebook">Facebook</a>
              <button id="shareSignal" type="button" data-i18n="shareSignal">Signal</button>
              <button id="shareInstagram" type="button" data-i18n="shareInstagram">Instagram</button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <script>
    // Minimal i18n: auto language via ?lang=xx or navigator.language, with localStorage.
    const SUPPORTED = [
      { code: 'fi', label: 'Suomi' },
      { code: 'en', label: 'English' },
      { code: 'sv', label: 'Svenska' },
      { code: 'no', label: 'Norsk' },
      { code: 'da', label: 'Dansk' },
      { code: 'is', label: 'Íslenska' },
      { code: 'de', label: 'Deutsch' },
      { code: 'es', label: 'Español' },
      { code: 'ar', label: 'العربية' },
    ];

    const I18N = {
      fi: {
        title: 'Codesphere – Digitaalinen käyntikortti',
        subtitle: 'Yhteystiedot',
        tagline: 'codesphere | globaalia ohjelmistokehitystä',
        downloadVcard: 'vCard',
        openPng: 'Avaa PNG-käyntikortti',
        shareLabel: 'Jaa',
        shareWhatsApp: 'WhatsApp',
        shareFacebook: 'Facebook',
        shareSignal: 'Signal',
        shareInstagram: 'Instagram',
        shareCopied: 'Linkki kopioitu',
        phonePrefix: 'puh',
        timoTitle: 'Toimitusjohtaja, Böethius Oy • Ohjelmistokehityksen asiantuntija',
        mattiTitle: 'Hallituksen jäsen • Markkinointijohtaja & Tekoälyarkkitehti',
        mikaTitle: 'Kyberturvallisuusasiantuntija • Asiantuntijatodistelu (tuomioistuimet)',
      },
      en: {
        title: 'Codesphere – Digital business card',
        subtitle: 'Contact',
        tagline: 'codesphere | global software development',
        downloadVcard: 'vCard',
        openPng: 'Open PNG card',
        shareLabel: 'Share',
        shareWhatsApp: 'WhatsApp',
        shareFacebook: 'Facebook',
        shareSignal: 'Signal',
        shareInstagram: 'Instagram',
        shareCopied: 'Link copied',
        phonePrefix: 'tel',
        timoTitle: 'CEO, Böethius Oy • Software development specialist',
        mattiTitle: 'Board member • Marketing Director & AI Architect',
        mikaTitle: 'Cybersecurity specialist • Expert testimony (courts)',
      },
      sv: {
        title: 'Codesphere – Digitalt visitkort',
        subtitle: 'Kontakt',
        tagline: 'codesphere | global mjukvaruutveckling',
        downloadVcard: 'vCard',
        openPng: 'Öppna PNG-kort',
        shareLabel: 'Dela',
        shareWhatsApp: 'WhatsApp',
        shareFacebook: 'Facebook',
        shareSignal: 'Signal',
        shareInstagram: 'Instagram',
        shareCopied: 'Länk kopierad',
        phonePrefix: 'tel',
        timoTitle: 'VD, Böethius Oy • Expert inom mjukvaruutveckling',
        mattiTitle: 'Styrelseledamot • Marknadschef & AI-arkitekt',
        mikaTitle: 'Cybersäkerhetsexpert • Sakkunnigutlåtanden (domstolar)',
      },
      no: {
        title: 'Codesphere – Digitalt visittkort',
        subtitle: 'Kontakt',
        tagline: 'codesphere | global programvareutvikling',
        downloadVcard: 'vCard',
        openPng: 'Åpne PNG-kort',
        shareLabel: 'Del',
        shareWhatsApp: 'WhatsApp',
        shareFacebook: 'Facebook',
        shareSignal: 'Signal',
        shareInstagram: 'Instagram',
        shareCopied: 'Lenke kopiert',
        phonePrefix: 'tlf',
        timoTitle: 'Daglig leder, Böethius Oy • Ekspert på programvareutvikling',
        mattiTitle: 'Styremedlem • Markedsdirektør & AI-arkitekt',
        mikaTitle: 'Cybersikkerhetsekspert • Sakkyndig vitnemål (domstoler)',
      },
      da: {
        title: 'Codesphere – Digitalt visitkort',
        subtitle: 'Kontakt',
        tagline: 'codesphere | global softwareudvikling',
        downloadVcard: 'vCard',
        openPng: 'Åbn PNG-kort',
        shareLabel: 'Del',
        shareWhatsApp: 'WhatsApp',
        shareFacebook: 'Facebook',
        shareSignal: 'Signal',
        shareInstagram: 'Instagram',
        shareCopied: 'Link kopieret',
        phonePrefix: 'tlf',
        timoTitle: 'Direktør, Böethius Oy • Ekspert i softwareudvikling',
        mattiTitle: 'Bestyrelsesmedlem • Marketingdirektør & AI-arkitekt',
        mikaTitle: 'Cybersikkerhedsekspert • Sagkyndig vidneudsagn (domstole)',
      },
      is: {
        title: 'Codesphere – Stafrænt nafnspjald',
        subtitle: 'Samskipti',
        tagline: 'codesphere | alþjóðleg hugbúnaðarþróun',
        downloadVcard: 'vCard',
        openPng: 'Opna PNG spjald',
        shareLabel: 'Deila',
        shareWhatsApp: 'WhatsApp',
        shareFacebook: 'Facebook',
        shareSignal: 'Signal',
        shareInstagram: 'Instagram',
        shareCopied: 'Tengill afritaður',
        phonePrefix: 'sími',
        timoTitle: 'Forstjóri, Böethius Oy • Sérfræðingur í hugbúnaðarþróun',
        mattiTitle: 'Stjórnarmaður • Markaðsstjóri & AI-arkitekt',
        mikaTitle: 'Netöryggissérfræðingur • Sérfróð vitnisburður (dómstólar)',
      },
      de: {
        title: 'Codesphere – Digitale Visitenkarte',
        subtitle: 'Kontakt',
        tagline: 'codesphere | globale Softwareentwicklung',
        downloadVcard: 'vCard',
        openPng: 'PNG-Karte öffnen',
        shareLabel: 'Teilen',
        shareWhatsApp: 'WhatsApp',
        shareFacebook: 'Facebook',
        shareSignal: 'Signal',
        shareInstagram: 'Instagram',
        shareCopied: 'Link kopiert',
        phonePrefix: 'tel',
        timoTitle: 'Geschäftsführer, Böethius Oy • Experte für Softwareentwicklung',
        mattiTitle: 'Vorstandsmitglied • Marketing Director & KI-Architekt',
        mikaTitle: 'Cybersicherheits-Experte • Sachverständigengutachten (Gerichte)',
      },
      es: {
        title: 'Codesphere – Tarjeta digital',
        subtitle: 'Contacto',
        tagline: 'codesphere | desarrollo de software global',
        downloadVcard: 'vCard',
        openPng: 'Abrir tarjeta PNG',
        shareLabel: 'Compartir',
        shareWhatsApp: 'WhatsApp',
        shareFacebook: 'Facebook',
        shareSignal: 'Signal',
        shareInstagram: 'Instagram',
        shareCopied: 'Enlace copiado',
        phonePrefix: 'tel',
        timoTitle: 'CEO, Böethius Oy • Especialista en desarrollo de software',
        mattiTitle: 'Miembro del consejo • Director de Marketing y Arquitecto de IA',
        mikaTitle: 'Especialista en ciberseguridad • Testimonio pericial (tribunales)',
      },
      ar: {
        title: 'Codesphere – بطاقة عمل رقمية',
        subtitle: 'معلومات التواصل',
        tagline: 'codesphere | تطوير برمجيات عالمي',
        downloadVcard: 'vCard',
        openPng: 'فتح بطاقة PNG',
        shareLabel: 'مشاركة',
        shareWhatsApp: 'WhatsApp',
        shareFacebook: 'Facebook',
        shareSignal: 'Signal',
        shareInstagram: 'Instagram',
        shareCopied: 'تم نسخ الرابط',
        phonePrefix: 'هاتف',
        timoTitle: 'المدير التنفيذي، Böethius Oy • مختص بتطوير البرمجيات',
        mattiTitle: 'عضو مجلس الإدارة • مدير التسويق ومهندس معمارية ذكاء اصطناعي',
        mikaTitle: 'مختص أمن سيبراني • شهادة خبير (المحاكم)',
      },
    };

    function normalizeLang(raw) {
      if (!raw) return 'fi';
      const lc = String(raw).toLowerCase();
      const base = lc.split('-')[0];
      return I18N[base] ? base : 'fi';
    }

    function getLangFromUrl() {
      const params = new URLSearchParams(location.search);
      const l = params.get('lang');
      return l ? normalizeLang(l) : null;
    }

    function setUrlLang(lang) {
      try {
        const url = new URL(location.href);
        url.searchParams.set('lang', lang);
        history.replaceState({}, '', url.toString());
      } catch {}
    }

    function shareUrlForLang(lang) {
      try {
        const url = new URL(location.href);
        url.searchParams.set('lang', lang);
        return url.toString();
      } catch {
        return location.href;
      }
    }

    function updateShareLinks(lang) {
      const t = I18N[lang] || I18N.fi;
      const shareUrl = shareUrlForLang(lang);
      const text = `Codesphere: ${shareUrl}`;

      const wa = document.getElementById('shareWhatsApp');
      if (wa) wa.href = `https://wa.me/?text=${encodeURIComponent(text)}`;

      const fb = document.getElementById('shareFacebook');
      if (fb) fb.href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;

      const signalBtn = document.getElementById('shareSignal');
      if (signalBtn) {
        signalBtn.onclick = async () => {
          if (navigator.share) {
            try {
              await navigator.share({ title: t.title, text, url: shareUrl });
              return;
            } catch {}
          }

          // Fallback: try deep link; if blocked/not installed, copy URL.
          try {
            location.href = `signal://send?text=${encodeURIComponent(text)}`;
            return;
          } catch {}

          try {
            await navigator.clipboard.writeText(shareUrl);
            alert(t.shareCopied);
          } catch {
            prompt(t.shareCopied, shareUrl);
          }
        };
      }

      const igBtn = document.getElementById('shareInstagram');
      if (igBtn) {
        igBtn.onclick = async () => {
          if (navigator.share) {
            try {
              await navigator.share({ title: t.title, text, url: shareUrl });
              return;
            } catch {}
          }
          // Instagram ei tue luotettavaa web-linkkijakoa desktopissa → kopioi linkki.
          try {
            await navigator.clipboard.writeText(shareUrl);
            alert(t.shareCopied);
          } catch {
            prompt(t.shareCopied, shareUrl);
          }
        };
      }
    }

    function applyLang(lang) {
      const t = I18N[lang] || I18N.fi;
      document.documentElement.lang = lang;
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
      document.title = t.title;

      document.querySelectorAll('[data-i18n]').forEach((el) => {
        const key = el.getAttribute('data-i18n');
        if (!key) return;
        const value = t[key];
        if (typeof value === 'string') el.textContent = value;
      });

      document.querySelectorAll('.phone[data-phone]').forEach((el) => {
        const num = el.getAttribute('data-phone') || '';
        el.textContent = `${t.phonePrefix} ${num}`.trim();
      });

      try { localStorage.setItem('codesphere_lang', lang); } catch {}

      const sel = document.getElementById('lang');
      if (sel) sel.value = lang;
      const selTop = document.getElementById('langTop');
      if (selTop) selTop.value = lang;

      setUrlLang(lang);
      updateShareLinks(lang);
    }

    function initLangUI() {
      const sels = [document.getElementById('lang'), document.getElementById('langTop')].filter(Boolean);
      for (const s of sels) {
        const sel = s;
        sel.innerHTML = '';
        for (const opt of SUPPORTED) {
          const o = document.createElement('option');
          o.value = opt.code;
          o.textContent = opt.label;
          sel.appendChild(o);
        }
        sel.addEventListener('change', () => applyLang(normalizeLang(sel.value)));
      }
    }

    function pickInitialLang() {
      const fromUrl = getLangFromUrl();
      if (fromUrl) return fromUrl;
      try {
        const saved = localStorage.getItem('codesphere_lang');
        if (saved) return normalizeLang(saved);
      } catch {}
      return normalizeLang(navigator.language || 'fi');
    }

    const buildTag = document.getElementById('buildTag');
    if (buildTag) {
      const v = new URLSearchParams(location.search).get('v');
      buildTag.textContent = `build ${v || 'main'}`;
    }

    initLangUI();
    applyLang(pickInitialLang());

    // Iframe fallback-esikatselu (ilman automaattista scrollausta)
    const iframe = document.getElementById('site');
    const poster = document.getElementById('poster');
    const openLive = document.getElementById('openLive');
    const orientationTip = null; // tip piilotettu
    const IFRAME_SRC = iframe ? iframe.getAttribute('data-src') : '';

    function shouldAutoLoad() {
      const conn = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
      // iOS/Safari: Network Information API puuttuu usein. Oletus: auto-load myös pienillä ruuduilla,
      // ellei käyttäjä ole kytkenyt säästötilaa (saveData).
      if (!conn) return true;
      if (conn.saveData) return false;
      if (typeof conn.downlink === 'number') return conn.downlink >= 2.5;
      if (conn.effectiveType) return ['4g', 'wifi'].includes(conn.effectiveType);
      return true;
    }

    function cacheBustedSrc() {
      if (!IFRAME_SRC) return "";
      const sep = IFRAME_SRC.includes("?") ? "&" : "?";
      return `${IFRAME_SRC}${sep}r=${Date.now()}`;
    }

    function loadIframe(bust = true) {
      if (!iframe || !IFRAME_SRC) return;
      const nextSrc = bust ? cacheBustedSrc() : IFRAME_SRC;
      iframe.src = nextSrc;
    }

    function showPoster(show) {
      if (!poster) return;
      poster.style.display = show ? 'grid' : 'none';
    }

    if (openLive) {
      openLive.addEventListener('click', () => {
        loadIframe();
        showPoster(false);
      });
    }

    const refreshBtn = document.getElementById('refreshFrame');
    if (refreshBtn) {
      refreshBtn.addEventListener('click', () => {
        loadIframe();
        showPoster(false);
      });
    }

    // Auto-load if connection is likely fast; otherwise wait for tap.
    if (shouldAutoLoad()) {
      loadIframe();
      showPoster(false);
    } else {
      showPoster(true);
    }

    // Fallback timeout: if iframe takes too long, keep poster visible.
    const fallbackTimer = setTimeout(() => showPoster(true), 2500);

    iframe?.addEventListener('load', () => {
      clearTimeout(fallbackTimer);
      showPoster(false);
    });

    // Auto-refresh the iframe periodically to keep preview fresh
    const AUTO_REFRESH_MS = 120000; // 2 min
    if (shouldAutoLoad() && iframe) {
      setInterval(() => {
        loadIframe();
        showPoster(false);
      }, AUTO_REFRESH_MS);
    }

    // orientation tip poistettu käytöstä
  </script>
</body>
</html>
